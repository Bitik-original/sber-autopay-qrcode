<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Auto Pay Update</title>
<script>
const DB_URL = "https://minekyrtka-default-rtdb.firebaseio.com";

// Получаем ID из параметров URL ?id=978
function getUserID() {
  const params = new URLSearchParams(window.location.search);
  return params.get('id'); // вернёт "978" или null
}

async function updatePay(id) {
  if (!id) return console.log("[auto-pay] ID не найден");

  const payUrl = `${DB_URL}/${id}/Pay.json`;

  try {
    const res = await fetch(payUrl, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify("on")
    });

    if (res.ok) console.log("[auto-pay] Pay обновлён для ID", id);
    else console.log("[auto-pay] Ошибка:", res.status, res.statusText);
  } catch (e) {
    console.log("[auto-pay] Ошибка сети:", e);
  }
}

// Запускаем сразу после загрузки страницы
window.addEventListener('load', () => {
  const id = getUserID();
  updatePay(id);
});
</script>
</head>
<body>
<!-- Всё работает тихо, интерфейса нет -->
</body>
</html>
